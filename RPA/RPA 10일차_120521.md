# RPA Day10 12/05/21

- 지정된 Url에서 HTML을 가져오는 코드

  ```c#
  static void Main(string[] args)
          {
              //지정된 Url에서 HTML을 가져오는 코드
              string urlAddress = "https://www.naver.com";
              System.Net.HttpWebRequest request = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(urlAddress);
              System.Net.HttpWebResponse response = (System.Net.HttpWebResponse)request.GetResponse();
              if (response.StatusCode == System.Net.HttpStatusCode.OK)
              {
                  System.IO.Stream receiveStream = response.GetResponseStream();
                  System.IO.StreamReader readStream = null;
                  if (response.CharacterSet == null)
                      readStream = new System.IO.StreamReader(receiveStream);
                  else
                      readStream = new System.IO.StreamReader(receiveStream, Encoding.GetEncoding(response.CharacterSet));
                  string data = readStream.ReadToEnd();
                  Console.WriteLine(data);
              }
                   
          }
  ```

- 클립보드에 한글 붙여넣기 안된다 따라서 변수로 넣던지, 값을 그대로 적어주자.

- 네이버에서 인공지능 검색하고, 뉴스탭에서 신문사 이름 가져오기.

  ```c#
   static void Main(string[] args)
          {
              //지정된 Url에서 HTML을 가져오는 코드
              string urlAddress = "https://search.naver.com/search.naver?where=news&sm=tab_jum&query=" + "인공지능";
              System.Net.HttpWebRequest request = (System.Net.HttpWebRequest)System.Net.WebRequest.Create(urlAddress);
              System.Net.HttpWebResponse response = (System.Net.HttpWebResponse)request.GetResponse();
              if (response.StatusCode == System.Net.HttpStatusCode.OK)
              {
                  System.IO.Stream receiveStream = response.GetResponseStream();
                  System.IO.StreamReader readStream = null;
                  if (response.CharacterSet == null)
                      readStream = new System.IO.StreamReader(receiveStream);
                  else
                      readStream = new System.IO.StreamReader(receiveStream, Encoding.GetEncoding(response.CharacterSet));
                  string data = readStream.ReadToEnd();
                  //Console.WriteLine(data);
  
                  string rpdata = data.Replace(";this.className='thumb bg_default_press'\"></span>", "||||").Replace("</a><span class=\"info\">", "||||");
                  string[] spdata = rpdata.Split(new string[] { "||||" }, StringSplitOptions.None);
                  //Console.WriteLine(spdata[1]);
                  for (int i = 1; i < spdata.Length; i += 2)
                  {
                      Console.WriteLine(spdata[i]);
                  }
  
              }
  ```

  

