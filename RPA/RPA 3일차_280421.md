# RPA 3일차 28/04/21

###### Set test to {	MessageBox.Show("test"); \n return 0;} :  메세지 뜨게 하는 창

- "test" 에 변수를 집어넣을 수 있다. C#코드에서 활용을 할 수 있다.

- 아마도 string변수만 출력 가능.. (@변수:변수형식@)으로 괄호 안에 삽입. 

  ### <별그리기...직각삼각형>

  ![image-20210428104019866](C:\Users\User\AppData\Roaming\Typora\typora-user-images\image-20210428104019866.png)

![image-20210428110856173](C:\Users\User\AppData\Roaming\Typora\typora-user-images\image-20210428110856173.png)

![image-20210428111114450](C:\Users\User\AppData\Roaming\Typora\typora-user-images\image-20210428111114450.png)

- \n을 문자로 가져간게 아니라 명령어로 가져가기 때문에 string 변수에 보이지 않음 .. 

#### 분기

###### Do -> Branch(분기) -> if true(조건추가)

- 장치관련 조건 추가하기
  - 해상도, 운영체제, 운영체제 및 버전, 장치 식별번호
- 조건추가
  - 조건식에 @LastResult.Code@ == 0
  - 기타-Result(자동생성 변수) 의 값은 0/-1 을 갖는다. 0: 정상적으로 작동/-1 : 오류, 실패
  - **<u>LastResult</u>**가 Class의 개념(Code, Msg), 따라서 Code값을 사용하기 위해서 LastResult.Code 라고 사용
  - LastResult = 마지막으로 실행된 명령어의 Result값이 들어간다.
- 삭제
- Why분기명령어 ? 갈림길에 들어섰을 때 .. 분기는 이정표의 역할을 한다. 순차실행(Do)과 비슷한 역할.
- 명령 수행 실패시 종료 여부
- ![image-20210428115517336](C:\Users\User\AppData\Roaming\Typora\typora-user-images\image-20210428115517336.png)
- ![image-20210428115529588](C:\Users\User\AppData\Roaming\Typora\typora-user-images\image-20210428115529588.png)

### 클립보드

- 문자열 밀어넣기(Ctrl+ C) -push //SetClipboardText
  - 입력텍스트에 텍스트 넣고, 실행한 뒤 메모장에 붙여넣기 하면 그 텍스트 붙여넣어짐 (복사를 하지 않아도)
- 문자열 가져오기() - pull //GetClipboardText
  - 인수값이 이름이다 . 변수이름을 적는 것 
  - 클립보드에서 문자열을 가져온 다음에 그 값을 변수에다가 넣어주는 것
  - 따라서 변수 이름만 필요하다.
- 이미지 밀어넣기
  - 이미지 경로 : 어디 주소, 어느 폴더..
  - 클립보드에 이미지 파일 들어간다.
  - 이미지 파일은 변수에 저장을 하지 못하기 때문에 이미지 가져오기를 할 수 없다.
  - ![image-20210428133309081](C:\Users\User\AppData\Roaming\Typora\typora-user-images\image-20210428133309081.png)
  - @"경로"

#### 이미지 패턴 수동 레코드

- Ctrl + shift + F : 이미지 패턴 수동 레코드

- Ctrl + Shift + U :사용자모드

###### 제일 바깥 쪽 화면 테두리, 붉은 테두리-마우스 오른쪽으로 드래그(이 내부에서 명령어를 선택 가능), 하늘색 테두리-붉은 테두리 내에서 ctrl + 마우스 왼쪽 

- 빨간색 점선 -> 하늘색 점선(템플릿 검색 영ㅇ역) -> 붉은색 실선(하늘색 점선 안에서만 만들 수 있음)
  - **왼쪽 버튼, 오른쪽 버튼** => 많이 사용 //MatchAndClickL, MatchAndClickR
  - **더블클릭** => 가끔..
  - **문자열 입력 기록** :키워드 입력(ex.로그인시 아이디 패스워드..)
  - **선택영역 확인기록: ** Match라는 명령어 생김.
    - 검색간격, 검색 제한시간을 주로 만진다(시간값 m/s단위) -ex)30000 => 30초
    - 특정 페이지, 특정 화면이 제대로 나오는지 확인을 하기 위해서 => 이 때 LastResult값을 활용해서 사용 또 분기를 사용해서 Check..
    - Sleep 1000 milliseconds : 실행 - 대기 // 페이지가 뜨기도 전에 화면이 넘어가서 클릭 되기 때문에 대기 해줘야 한다.
  - 영역 내 문자 인식 후... (여기서 영역은 붉은색 실선 안에 문자 인식하는 것) , 해당 내 영역에 있는 모든 글자와 그림을 인식하려고 노력..

- 핫키 자동입력 : 만약 단축키를 문자열입력칸에 넣어야 한다면 단축키 누르고.. ((LeftCtrl)C)
  - 클릭을 안하고 바로 적을 것이다 => 터치 후 입력 토글 해제 ..

#### 오브젝트 : 마우스 클릭 없이 가능..

###### 오브젝트 - 드라이버 시작 => 실제로는 웹사이트 열 때 이미지 매칭보다 많이 사용

- 드라이버 식별명: 변수이름
- 객체형식 : Chrome , explore, Firefox, Win32 => Web Browser
  - 시작 URL/프로그램 : "URL  주소" / "https://www.naver.com/" => Chrome 안되면 InternetExplorer
- 확인 : 특정 이미지, 문자열 or 기능들이 있는지 없는지 확인
  - 드라이버 식별명 : 현재 동작이 진행될 대상을 지정 //objStartDriver의 드라이버 식별명과 같은 것으로
  - 검색대상객체 
    - 객체 검색값: 
    - 검색 방식 : XPath (거의 대부분 XPath) => 크롬에서 F12 눌러주면 개발자모드(Ctrl + Shift + C ) => 원하는 element => html 코드에서 우클릭 => copy xpath => 메모장에 붙여놓고, 큰따옴표를 작은따옴표로 바꿔준다.(문자열로 인식하기 떄문에 큰 따옴표로 감싸준다.) 
    - 그 다음에 객체 검색값에 그대로 붙여넣어준다.
- 클릭
- 텍스트 입력 다 있다..
- select : 셀렉트를 찾고 옵션을 찾는다. (객체 검색값에 접혀져 있는 메뉴..)(옵션값에 제주도넣으면 제주도 선택된다.)
- 윈도우 컨트롤: 주로 사용하는 것은 Maximize , 그리고 드라이브를 여러개를 쓰면은 setFocus
  - 화면 여러개가 있을 때 드라이브가 여러개 있을 때 메인이냐 서브냐 적절하게 바꿔줘야 한다.
  - 네이버 화면(메인 포커스) 떠 있고 다른 탭에 기상청 탭(서브 포커스)